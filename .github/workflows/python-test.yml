name: Python Labs Tests 

on:
  push:
    branches: [ main, master ] 
  pull_request:
    branches: [ main, master ] 

jobs:
  test_lab_work: 
    name: Run tests for ${{ matrix.lab_name }}
    runs-on: ubuntu-latest 

    strategy:
      fail-fast: false 
      matrix:

        lab_name:
          - lab_work_1
          - lab_work_2
          # - discrete-mathematics/lab_work_1

    steps:
    - name: Checkout repository 
      uses: actions/checkout@v3

    - name: Set up Python 
      uses: actions/setup-python@v4
      with:
        python-version: '3.10' 

    - name: Cache pip dependencies 
      uses: actions/cache@v3
      with:
        path: ~/.cache/pip
        key: ${{ runner.os }}-pip-${{ hashFiles('promising-programming-languages/${{ matrix.lab_name }}/requirements.txt') }} 
        restore-keys: |
          ${{ runner.os }}-pip-
    
    - name: Install dependencies for ${{ matrix.lab_name }} 
      run: |
        python -m pip install --upgrade pip
        # Если у вас есть requirements.txt в папке лабы, используйте:
        # pip install -r requirements.txt
        pip install pytest # Установить только pytest
      working-directory: promising-programming-languages/${{ matrix.lab_name }} 

    - name: Run Pytest Tests for ${{ matrix.lab_name }} 
      run: pytest -v -s 
      working-directory: promising-programming-languages/${{ matrix.lab_name }} 